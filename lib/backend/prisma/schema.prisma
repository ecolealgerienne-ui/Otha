generator client {
  provider      = "prisma-client-js"
  binaryTargets = ["native", "linux-musl-openssl-3.0.x"]
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum Role {
  USER
  PRO
  ADMIN
}

enum BookingStatus {
  PENDING
  CONFIRMED
  CANCELLED
  COMPLETED
  AWAITING_CONFIRMATION
  PENDING_PRO_VALIDATION
  DISPUTED
  EXPIRED
}

enum Gender {
  MALE
  FEMALE
  UNKNOWN
}

enum Sex {
  M
  F
  U
}

enum AdoptStatus {
  PENDING
  APPROVED
  REJECTED
  ARCHIVED
  ADOPTED
}

enum AdoptAction {
  LIKE
  PASS
}

enum AdoptRequestStatus {
  PENDING   // En attente de r√©ponse du propri√©taire
  ACCEPTED  // Accept√© ‚Üí conversation ouverte
  REJECTED  // Refus√© par le propri√©taire
}

model User {
  id        String  @id @default(cuid())
  email     String  @unique
  password  String? // Optionnel si Google OAuth
  role      Role    @default(USER)
  firstName String?
  lastName  String?

  // OAuth
  googleId  String? @unique // Google OAuth ID

  // Contact / profil
  phone    String? @unique
  city     String?
  lat      Float?
  lng      Float?
  photoUrl String?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  providerProfile ProviderProfile?
  bookings        Booking[]
  reviews         Review[]
  refreshTokens   RefreshToken[]
  pets            Pet[]
  orders          Order[]
  daycareBookings DaycareBooking[]

  // Adoption (nouvelle impl√©mentation)
  adoptPosts             AdoptPost[]
  adoptSwipes            AdoptSwipe[]
  adoptRequests          AdoptRequest[]
  conversationsAsOwner   AdoptConversation[] @relation("ConversationOwner")
  conversationsAsAdopter AdoptConversation[] @relation("ConversationAdopter")

  // Notifications
  notifications Notification[]
  adoptMessages          AdoptMessage[]
  adoptedPosts           AdoptPost[]         @relation("AdoptedPosts") // Posts qu'il a adopt√©s

  // Quotas adoption (r√©initialisation quotidienne)
  dailySwipeCount Int      @default(0)
  dailyPostCount  Int      @default(0)
  lastSwipeDate   DateTime?
  lastPostDate    DateTime?

  @@index([email])
  @@index([city])
  @@index([lat, lng])
}

model ProviderProfile {
  id          String  @id @default(cuid())
  userId      String  @unique
  displayName String
  bio         String?
  lat         Float?
  lng         Float?
  address     String?
  specialties Json?
  timezone    String?

  isApproved      Boolean   @default(false)
  appliedAt       DateTime  @default(now())
  rejectedAt      DateTime?
  rejectionReason String?

  // Documents v√©t√©rinaires (carte AVN)
  avnCardFront    String?   // URL de la carte AVN recto
  avnCardBack     String?   // URL de la carte AVN verso

  user     User                   @relation(fields: [userId], references: [id])
  services Service[]
  bookings Booking[]
  weekly   ProviderAvailability[]
  timeOffs ProviderTimeOff[]

  // Back-relations
  earnings        ProviderEarning[]
  collections     AdminCollection[]
  products        Product[]
  orders          Order[]
  daycareBookings DaycareBooking[]

  @@index([userId])
  @@index([lat, lng])
}

model ProviderAvailability {
  id         String @id @default(cuid())
  providerId String
  weekday    Int
  startMin   Int
  endMin     Int

  provider ProviderProfile @relation(fields: [providerId], references: [id], onDelete: Cascade)

  @@unique([providerId, weekday, startMin, endMin])
  @@index([providerId, weekday])
}

model ProviderTimeOff {
  id         String   @id @default(cuid())
  providerId String
  startsAt   DateTime
  endsAt     DateTime
  reason     String?

  createdAt DateTime @default(now())

  provider ProviderProfile @relation(fields: [providerId], references: [id], onDelete: Cascade)

  @@index([providerId, startsAt])
}

model Service {
  id          String  @id @default(cuid())
  providerId  String
  title       String
  description String?
  price       Decimal @db.Decimal(10, 2)
  durationMin Int

  archivedAt DateTime?
  createdAt  DateTime  @default(now())
  updatedAt  DateTime  @updatedAt

  provider ProviderProfile @relation(fields: [providerId], references: [id])
  bookings Booking[]

  // Back-relation
  earnings ProviderEarning[]

  @@index([providerId, title])
  @@index([providerId, archivedAt])
  @@index([providerId, createdAt])
}

model Booking {
  id          String        @id @default(cuid())
  userId      String
  providerId  String
  serviceId   String
  status      BookingStatus @default(PENDING)
  scheduledAt DateTime
  createdAt   DateTime      @default(now())

  // Champs sp√©cifiques pour les garderies
  petIds       String[]  @default([])  // IDs des animaux concern√©s
  clientNotes  String?                 // Notes du client
  endDate      DateTime?               // Date de fin (pour r√©servations journali√®res)
  commissionDa Int?                    // Commission en DA

  // Syst√®me de confirmation RDV
  gracePeriodEndsAt    DateTime? // Fin de la p√©riode de gr√¢ce (48h apr√®s scheduledAt)
  clientConfirmedAt    DateTime? // Quand le client a confirm√©
  proConfirmedAt       DateTime? // Quand le pro a confirm√© (scan QR ou validation manuelle)
  proResponseDeadline  DateTime? // Deadline pour validation pro (72h apr√®s clientConfirmedAt)
  cancellationReason   String?   // Raison d'annulation
  disputeNote          String?   // Note du litige (si DISPUTED)

  user     User            @relation(fields: [userId], references: [id])
  provider ProviderProfile @relation(fields: [providerId], references: [id])
  service  Service         @relation(fields: [serviceId], references: [id])
  review   Review?

  // Back-relation 1‚Äì1
  earning ProviderEarning?

  @@index([providerId, scheduledAt])
  @@index([userId, scheduledAt])
  @@index([status, gracePeriodEndsAt])
}

model Review {
  id        String   @id @default(cuid())
  bookingId String   @unique
  userId    String
  rating    Int
  comment   String?
  isPending Boolean  @default(false) // Avis en attente (cr√©√© lors de la confirmation client)
  createdAt DateTime @default(now())

  booking Booking @relation(fields: [bookingId], references: [id])
  user    User    @relation(fields: [userId], references: [id])

  @@index([userId])
  @@index([isPending])
}

model Pet {
  id              String    @id @default(cuid())
  ownerId         String
  name            String
  species         String?   // dog, cat, bird, rodent, reptile, other
  gender          Gender    @default(UNKNOWN)
  birthDate       DateTime? // Date de naissance pour calcul d'√¢ge
  weightKg        Decimal?  @db.Decimal(5, 2)
  color           String?
  country         String?
  idNumber        String?   // Puce/tatouage
  microchipNumber String?   // Num√©ro de puce √©lectronique
  breed           String?
  bloodType       String?   // Groupe sanguin
  isNeutered      Boolean   @default(false)
  neuteredAt      DateTime?
  photoUrl        String?
  allergiesNotes  String?   // Notes rapides sur les allergies
  description     String?   // Description/notes g√©n√©rales
  createdAt       DateTime  @default(now())
  updatedAt       DateTime  @updatedAt

  owner            User                @relation(fields: [ownerId], references: [id])
  medicalRecords   MedicalRecord[]
  accessTokens     PetAccessToken[]
  weightRecords    WeightRecord[]
  vaccinations     Vaccination[]
  treatments       Treatment[]
  allergies        Allergy[]
  preventiveCare   PreventiveCare[]
  diseaseTrackings DiseaseTracking[]
  daycareBookings  DaycareBooking[]

  @@index([ownerId])
}

// Suivi du poids avec historique
model WeightRecord {
  id        String   @id @default(cuid())
  petId     String
  weightKg  Decimal  @db.Decimal(5, 2)
  date      DateTime
  notes     String?
  createdAt DateTime @default(now())

  pet Pet @relation(fields: [petId], references: [id], onDelete: Cascade)

  @@index([petId, date])
}

// Vaccinations avec rappels
model Vaccination {
  id          String    @id @default(cuid())
  petId       String
  name        String    // Rage, CHPL, Typhus, Coryza, etc.
  date        DateTime
  nextDueDate DateTime? // Date du prochain rappel
  batchNumber String?   // Num√©ro de lot
  vetId       String?
  vetName     String?
  notes       String?
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt

  pet Pet @relation(fields: [petId], references: [id], onDelete: Cascade)

  @@index([petId, date])
  @@index([petId, nextDueDate])
}

// Traitements et m√©dicaments
model Treatment {
  id          String    @id @default(cuid())
  petId       String
  name        String    // Nom du m√©dicament
  dosage      String?   // Ex: "1 comprim√©"
  frequency   String?   // Ex: "2x/jour"
  startDate   DateTime
  endDate     DateTime?
  isActive    Boolean   @default(true)
  notes       String?
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt

  pet Pet @relation(fields: [petId], references: [id], onDelete: Cascade)

  @@index([petId, isActive])
  @@index([petId, startDate])
}

// Allergies (critique pour les pros)
model Allergy {
  id        String   @id @default(cuid())
  petId     String
  type      String   // drug, food, environment
  allergen  String   // Ex: "P√©nicilline", "Poulet"
  severity  String?  // mild, moderate, severe
  notes     String?
  createdAt DateTime @default(now())

  pet Pet @relation(fields: [petId], references: [id], onDelete: Cascade)

  @@index([petId])
}

// Soins pr√©ventifs (vermifugation, antiparasitaires, dentaire)
model PreventiveCare {
  id          String    @id @default(cuid())
  petId       String
  type        String    // deworming, flea_tick, dental, other
  lastDate    DateTime
  nextDueDate DateTime?
  product     String?   // Produit utilis√©
  notes       String?
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt

  pet Pet @relation(fields: [petId], references: [id], onDelete: Cascade)

  @@index([petId, type])
  @@index([petId, nextDueDate])
}

// Suivi de maladie avec photos et √©volution
model DiseaseTracking {
  id          String   @id @default(cuid())
  petId       String
  name        String   // Nom de la maladie (ex: "Allergie cutan√©e", "Otite")
  description String?  // Description de la maladie
  status      String   // ONGOING (en cours), CURED (gu√©rie), CHRONIC (chronique), MONITORING (surveillance)
  severity    String?  // MILD (l√©g√®re), MODERATE (mod√©r√©e), SEVERE (s√©v√®re)

  // Dates importantes
  diagnosisDate DateTime  // Date du diagnostic
  curedDate     DateTime? // Date de gu√©rison (si applicable)

  // Informations m√©dicales
  vetId       String?  // V√©t√©rinaire qui a diagnostiqu√©
  vetName     String?
  symptoms    String?  // Sympt√¥mes observ√©s
  treatment   String?  // Traitement en cours

  // Suivi avec photos
  images      String[] // URLs des photos (√©chographies, radios, photos progression)

  // Notes d'√©volution
  notes       String?  @db.Text // Notes d√©taill√©es sur l'√©volution

  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  pet Pet @relation(fields: [petId], references: [id], onDelete: Cascade)

  // Entr√©es d'√©volution (timeline)
  progressEntries DiseaseProgressEntry[]

  @@index([petId, status])
  @@index([petId, diagnosisDate])
}

// Entr√©es de progression pour une maladie (timeline)
model DiseaseProgressEntry {
  id              String   @id @default(cuid())
  diseaseId       String
  date            DateTime
  notes           String   @db.Text // Notes sur l'√©volution √† cette date
  images          String[] // Photos sp√©cifiques √† cette entr√©e
  severity        String?  // S√©v√©rit√© √† ce moment (peut changer)
  treatmentUpdate String?  // Mise √† jour du traitement
  createdAt       DateTime @default(now())

  disease DiseaseTracking @relation(fields: [diseaseId], references: [id], onDelete: Cascade)

  @@index([diseaseId, date])
}

model MedicalRecord {
  id          String   @id @default(cuid())
  petId       String
  type        String   // VACCINATION, SURGERY, CHECKUP, TREATMENT, MEDICATION, VET_VISIT, DAYCARE_VISIT, OTHER
  title       String
  description String?
  date        DateTime
  vetId       String?  // Provider ID du v√©t√©rinaire (optionnel)
  vetName     String?  // Nom du v√©t√©rinaire/garderie
  notes       String?
  images      String[] // URLs des images (radios, ordonnances, etc.)

  // üîó Lien avec les bookings (pour historique automatique)
  bookingId         String? // ID du booking v√©t√©rinaire (si cr√©√© par scan QR)
  daycareBookingId  String? // ID du booking garderie (si cr√©√© par scan QR)
  providerType      String? // VET ou DAYCARE (pour diff√©rencier l'origine)
  durationMinutes   Int?    // Dur√©e de la visite en minutes

  // üè• Donn√©es de sant√© enregistr√©es lors de la visite
  weightKg      Decimal? @db.Decimal(5, 2) // Poids en kg (ex: 12.50)
  temperatureC  Decimal? @db.Decimal(4, 2) // Temp√©rature en ¬∞C (ex: 38.50)
  heartRate     Int?     // Fr√©quence cardiaque (battements/min)

  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  pet Pet @relation(fields: [petId], references: [id], onDelete: Cascade)

  @@index([petId, date])
  @@index([petId, type])
  @@index([bookingId])
  @@index([daycareBookingId])
}

model PetAccessToken {
  id        String   @id @default(cuid())
  petId     String
  token     String   @unique
  expiresAt DateTime
  createdAt DateTime @default(now())

  pet Pet @relation(fields: [petId], references: [id], onDelete: Cascade)

  @@index([token])
  @@index([petId, expiresAt])
}

model RefreshToken {
  id        String   @id @default(cuid())
  userId    String
  tokenHash String
  expiresAt DateTime

  user User @relation(fields: [userId], references: [id])

  @@index([userId, expiresAt])
}

// =========================
// Adoption (nouvelle base)
// =========================

model AdoptPost {
  id        String      @id @default(cuid())
  createdAt DateTime    @default(now())
  updatedAt DateTime    @updatedAt
  status    AdoptStatus @default(PENDING)

  animalName  String   // Nom de l'animal (affich√© publiquement)
  title       String   // Titre annonce (legacy, peut √™tre = animalName)
  description String?
  species     String
  sex         Sex      @default(U)
  ageMonths   Int?
  size        String?
  color       String?
  city        String?
  address     String?
  mapsUrl     String?
  lat         Float?
  lng         Float?

  createdById String
  createdBy   User   @relation(fields: [createdById], references: [id])

  moderationNote     String?
  approvedAt         DateTime?
  rejectedAt         DateTime?
  archivedAt         DateTime?
  adoptedAt          DateTime? // Quand l'animal a √©t√© adopt√©
  adoptedById        String?   // User qui a adopt√© l'animal
  adoptedBy          User?     @relation("AdoptedPosts", fields: [adoptedById], references: [id])
  petProfileCreated  Boolean   @default(false) // Si l'adoptant a cr√©√© le profil pet

  images        AdoptImage[]
  swipes        AdoptSwipe[]
  requests      AdoptRequest[]
  conversations AdoptConversation[]

  @@index([status, createdAt])
  @@index([lat, lng])
}

model AdoptImage {
  id     String @id @default(cuid())
  url    String
  width  Int?
  height Int?
  order  Int    @default(0)

  postId String
  post   AdoptPost @relation(fields: [postId], references: [id], onDelete: Cascade)

  @@index([postId, order])
}

model AdoptSwipe {
  id        String      @id @default(cuid())
  createdAt DateTime    @default(now())
  updatedAt DateTime    @updatedAt
  action    AdoptAction

  userId String
  user   User   @relation(fields: [userId], references: [id], onDelete: Cascade)

  postId String
  post   AdoptPost @relation(fields: [postId], references: [id], onDelete: Cascade)

  @@unique([userId, postId])
  @@index([action, createdAt])
}

// Demande d'adoption (cr√©√©e quand user swipe droite)
model AdoptRequest {
  id        String             @id @default(cuid())
  createdAt DateTime           @default(now())
  updatedAt DateTime           @updatedAt
  status    AdoptRequestStatus @default(PENDING)

  // User qui veut adopter (celui qui a swip√© droite)
  requesterId String
  requester   User   @relation(fields: [requesterId], references: [id], onDelete: Cascade)

  // Annonce concern√©e
  postId String
  post   AdoptPost @relation(fields: [postId], references: [id], onDelete: Cascade)

  // Conversation cr√©√©e si accept√©
  conversationId String?           @unique
  conversation   AdoptConversation? @relation(fields: [conversationId], references: [id])

  @@unique([requesterId, postId]) // Une seule demande par user par post
  @@index([postId, status])
  @@index([requesterId, status])
}

// Conversation entre propri√©taire et adoptant (apr√®s acceptation)
model AdoptConversation {
  id        String   @id @default(cuid())
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  // Annonce concern√©e
  postId String
  post   AdoptPost @relation(fields: [postId], references: [id], onDelete: Cascade)

  // Propri√©taire de l'annonce
  ownerId String
  owner   User   @relation("ConversationOwner", fields: [ownerId], references: [id], onDelete: Cascade)

  // Adoptant (user qui a fait la demande)
  adopterId String
  adopter   User   @relation("ConversationAdopter", fields: [adopterId], references: [id], onDelete: Cascade)

  // Noms anonymes g√©n√©r√©s
  ownerAnonymousName   String // Ex: "Ami des Animaux"
  adopterAnonymousName String // Ex: "C≈ìur Tendre"

  // Confirmation d'adoption en attente
  pendingAdoptionConfirmation Boolean   @default(false)
  pendingAdoptionRequestedAt  DateTime?

  // Soft delete : masquage par user sans suppression DB
  hiddenByOwner   Boolean @default(false)
  hiddenByAdopter Boolean @default(false)

  // Signalement de conversation
  reportedByOwner       Boolean   @default(false)
  reportReasonByOwner   String?
  reportedAtByOwner     DateTime?
  reportedByAdopter     Boolean   @default(false)
  reportReasonByAdopter String?
  reportedAtByAdopter   DateTime?

  messages      AdoptMessage[]
  adoptRequests AdoptRequest[]

  @@unique([postId, ownerId, adopterId]) // Une conversation unique par trio
  @@index([ownerId])
  @@index([adopterId])
  @@index([adopterId, pendingAdoptionConfirmation]) // Pour trouver les confirmations pendantes
}

// Messages dans une conversation
model AdoptMessage {
  id        String   @id @default(cuid())
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  conversationId String
  conversation   AdoptConversation @relation(fields: [conversationId], references: [id], onDelete: Cascade)

  // Auteur du message
  senderId String
  sender   User   @relation(fields: [senderId], references: [id], onDelete: Cascade)

  content String @db.Text
  readAt  DateTime? // Quand le destinataire l'a lu

  @@index([conversationId, createdAt])
  @@index([senderId])
}

model ProviderEarning {
  id         String @id @default(cuid())
  providerId String
  bookingId  String @unique
  serviceId  String

  // Montants en dinars
  grossPriceDa    Int
  commissionDa    Int
  netToProviderDa Int

  createdAt DateTime  @default(now())
  paidAt    DateTime?

  provider ProviderProfile @relation(fields: [providerId], references: [id], onDelete: Cascade)
  booking  Booking         @relation(fields: [bookingId], references: [id], onDelete: Cascade)
  service  Service         @relation(fields: [serviceId], references: [id], onDelete: Cascade)

  @@index([providerId, createdAt])
}

model AdminCollection {
  id          String   @id @default(cuid())
  providerId  String
  month       String // 'YYYY-MM'
  amountDa    Int
  collectedAt DateTime @default(now())
  note        String?

  provider ProviderProfile @relation(fields: [providerId], references: [id], onDelete: Cascade)

  @@unique([providerId, month])
  @@index([providerId, month])
}

// Flag admin pour signaler les comptes/RDV suspects
model AdminFlag {
  id        String   @id @default(cuid())
  userId    String
  type      String
  bookingId String?
  note      String?
  createdAt DateTime @default(now())
  resolved  Boolean  @default(false)

  @@index([userId, resolved])
  @@index([createdAt])
}

// =========================
// Petshop (Animalerie)
// =========================

enum OrderStatus {
  PENDING
  CONFIRMED
  SHIPPED
  DELIVERED
  CANCELLED
}

model Product {
  id          String   @id @default(cuid())
  providerId  String
  title       String
  description String
  priceDa     Int      // Prix en dinars alg√©riens
  stock       Int?     // Stock disponible (null = illimit√©)
  category    String?  // Cat√©gorie du produit
  imageUrls   Json?    // Array de strings (URLs des images)
  active      Boolean  @default(true) // Visible pour les clients
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  provider   ProviderProfile @relation(fields: [providerId], references: [id], onDelete: Cascade)
  orderItems OrderItem[]

  @@index([providerId])
  @@index([active])
  @@index([providerId, active])
}

model Order {
  id              String      @id @default(cuid())
  userId          String      // Client qui a pass√© la commande
  providerId      String      // Animalerie
  status          OrderStatus @default(PENDING)
  totalDa         Int         // Total en dinars alg√©riens
  phone           String?     // Num√©ro de t√©l√©phone du client
  deliveryAddress String?     // Adresse de livraison
  notes           String?     // Notes/instructions du client
  createdAt       DateTime    @default(now())
  updatedAt       DateTime    @updatedAt

  user   User            @relation(fields: [userId], references: [id])
  provider ProviderProfile @relation(fields: [providerId], references: [id])
  items  OrderItem[]

  @@index([userId])
  @@index([providerId])
  @@index([status])
  @@index([providerId, status])
}

model OrderItem {
  id        String @id @default(cuid())
  orderId   String
  productId String
  quantity  Int    @default(1)
  priceDa   Int    // Prix unitaire au moment de la commande

  order   Order   @relation(fields: [orderId], references: [id], onDelete: Cascade)
  product Product @relation(fields: [productId], references: [id])

  @@index([orderId])
  @@index([productId])
}

// =========================
// Daycare (Garderie)
// =========================

enum DaycareBookingStatus {
  PENDING       // En attente de confirmation
  CONFIRMED     // Confirm√© par la garderie
  IN_PROGRESS   // Animal d√©pos√© (heure d'arriv√©e enregistr√©e)
  COMPLETED     // Animal r√©cup√©r√© (heure de d√©part enregistr√©e)
  CANCELLED     // Annul√©
}

model DaycareBooking {
  id              String                @id @default(cuid())
  userId          String                // Propri√©taire de l'animal
  providerId      String                // Garderie
  petId           String                // Animal concern√©
  status          DaycareBookingStatus  @default(PENDING)

  // Dates pr√©vues
  startDate       DateTime              // Date/heure de d√©p√¥t pr√©vue
  endDate         DateTime              // Date/heure de r√©cup√©ration pr√©vue

  // Heures r√©elles
  actualDropOff   DateTime?             // Heure r√©elle de d√©p√¥t
  actualPickup    DateTime?             // Heure r√©elle de r√©cup√©ration

  // Tarification
  priceDa         Int                   // Prix de base
  commissionDa    Int       @default(100)  // Commission fixe 100 DA
  totalDa         Int                   // Prix total pay√© par client

  notes           String?               // Notes du client
  createdAt       DateTime              @default(now())
  updatedAt       DateTime              @updatedAt

  user     User            @relation(fields: [userId], references: [id])
  provider ProviderProfile @relation(fields: [providerId], references: [id])
  pet      Pet             @relation(fields: [petId], references: [id])

  @@index([userId])
  @@index([providerId])
  @@index([petId])
  @@index([providerId, startDate])
  @@index([status])
}

enum NotificationType {
  NEW_ADOPT_MESSAGE      // Nouveau message dans une conversation d'adoption
  ADOPT_REQUEST_RECEIVED // Nouvelle demande d'adoption re√ßue
  ADOPT_REQUEST_ACCEPTED // Demande d'adoption accept√©e
  ADOPT_REQUEST_REJECTED // Demande d'adoption rejet√©e
  ADOPT_POST_APPROVED    // Annonce d'adoption approuv√©e par admin
  ADOPT_POST_REJECTED    // Annonce d'adoption rejet√©e par admin
  BOOKING_CONFIRMED      // Rendez-vous v√©t√©rinaire confirm√©
  BOOKING_CANCELLED      // Rendez-vous v√©t√©rinaire annul√©
  ORDER_SHIPPED          // Commande PetShop exp√©di√©e
  ORDER_DELIVERED        // Commande PetShop livr√©e
  GENERAL                // Notification g√©n√©rale
  BOOKING_NEEDS_VALIDATION
}

model Notification {
  id        String           @id @default(cuid())
  userId    String
  type      NotificationType @default(GENERAL)
  title     String
  body      String
  metadata  Json?            // Donn√©es suppl√©mentaires (IDs, URLs, etc.)
  read      Boolean          @default(false)
  createdAt DateTime         @default(now())

  user User @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@index([userId, read])
  @@index([userId, createdAt])
}
